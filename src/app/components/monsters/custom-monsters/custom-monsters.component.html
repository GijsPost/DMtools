<div class="container">
  <h1>Custom Monsters</h1>
  <p>
    Here you can add your own custom monsters.
  </p>
  <hr>

  <div class="row">
    <div class="col-md">
      <table class="table">
        <thead>
          <tr>
            <th>Name</th>
            <th>CR</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let monster of resourceService.customMonsters" (click)="selected = monster">
            <td>{{monster.name}}</td>
            <td>{{monster.challenge_rating}}</td>
            <td><i class="fas fa-times-circle fa-2x delete-icon" (click)="removeMonster(monster)"></i></td>
          </tr>
        </tbody>
      </table>

      <button type="button" class="btn btn-primary" routerLink="/monsters/custom/create" style="margin-right:1%">Add New Monster</button>

    </div>
    <div class="col-md">
      <button type="button" class="btn btn-success" (click)="downloadMonsters()" style="margin-right:1%"><i class="fas fa-download"></i> Export</button>
      <button type="button" class="btn btn-info" data-toggle="collapse" data-target="#collapseExample" aria-expanded="false" aria-controls="collapseExample"><i class="fas fa-upload"></i> Import</button>
      <div class="collapse" id="collapseExample">
        <div class="card card-body">
            <p>Upload or Drop Custom Monster JSON file here (WARNING: Overrides already set custom monsters! Export before you import)</p>
          <input class="import-field" type="file" (change)="fileUpload($event)" id="fileDrop" />
        </div>
      </div>




      <div class="card" style="margin: 3%; background-color:#fdfceb" *ngIf="selected != null || selected != undefined">
          <div class="card-body">
              <h3 class="card-title">{{ selected.name }}</h3>
              <h4><i>{{ selected.size + " " + selected.type + " " + ((selected.subtype) ? selected.subtype : '') }} (CR {{ selected.challenge_rating }})</i></h4>
              <p>
                  <span class="badge badge-info">Strength {{ selected.strength + " ( " + (abc.get(selected.strength) > 0 ? '+' : '') + abc.get(selected.strength) + " )" }}</span>
                  <span class="badge badge-info">Dexterity {{ selected.dexterity + " ( " + (abc.get(selected.dexterity) > 0 ? '+' : '') + abc.get(selected.dexterity) + " )" }}</span>
                  <span class="badge badge-info">Constitution {{ selected.constitution + " ( " + (abc.get(selected.constitution)  > 0 ? '+' : '') + abc.get(selected.constitution) + " )"}}</span>
                  <span class="badge badge-info">Wisdom {{ selected.wisdom + " ( " + (abc.get(selected.wisdom) > 0 ? '+' : '') + abc.get(selected.wisdom)  + " )" }}</span>
                  <span class="badge badge-info">Intelligence {{ selected.intelligence + " ( " + (abc.get(selected.intelligence) > 0 ? '+' : '') + abc.get(selected.intelligence) + " )" }}</span>
                  <span class="badge badge-info">Charisma {{ selected.charisma + " ( " + (abc.get(selected.charisma) > 0 ? '+' : '') + abc.get(selected.charisma) +" )" }}</span>
              </p>
              <hr />
              <div class="row">
                  <div class="col-md">
                      <div *ngIf="selected.speed != ''">
                          <b>Speed</b><br />
                          {{ selected.speed }}
                      </div>
                      <div *ngIf="selected.senses != ''">
                          <b>Senses</b><br />
                          {{ selected.senses }}
                      </div>
                      <div *ngIf="selected.languages != ''">
                          <b>Languages</b><br />
                          {{ selected.languages }}
                      </div>
                  </div>
                  <div class="col-md">
                      <div *ngIf="selected.damage_vulnerabilities != ''">
                          <b>Vulnerabilities: </b><br />
                          {{ selected.damage_vulnerabilities }}
                      </div>
                      <div *ngIf="selected.damage_resistances != ''">
                          <b>Resistances: </b>
                          {{ selected.damage_resistances }}
                      </div>
                      <div *ngIf="selected.damage_immunities != ''">
                          <b>Immunities: </b>
                          {{ selected.damage_immunities + ", " + selected.condition_immunities}}
                      </div>
                  </div>
              </div>
              <hr />
              <h4>Special Abilities</h4>
              <div *ngFor="let abil of selected.special_abilities">
                  <p><b>{{ abil.name }}</b></p>
                  <p>{{ abil.desc }}</p>
              </div>
              <hr />
              <h4>Actions</h4>
              <div *ngFor="let action of selected.actions">
                  <p><b>{{ action.name }}</b></p>
                  <p>
                      {{ action.desc }}
                      <span class="badge badge-warning" *ngIf="action.attack_bonus != 0">attack +{{ action.attack_bonus }}</span>
                      <span class="badge badge-warning" *ngIf="action.attack_bonus != 0">{{ action.damage_dice }} +{{action.damage_bonus != null ? action.damage_bonus : '0'}}</span>
                  </p>
      
              </div>
              <hr />
              <h4>Legendary Actions</h4>
              <div *ngFor="let legac of selected.legendary_actions">
                  <p><b>{{ legac.name }}</b></p>
                  <p>{{ legac.desc }}</p>
              </div>
          </div>
      </div>
      
    </div>
  </div>
</div>

